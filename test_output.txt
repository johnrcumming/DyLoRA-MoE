Loading model from: ./artifacts/best-dylora-model-full-v16/best_model
Initializing a decoder model: ./artifacts/best-dylora-model-full-v16/best_model ...
Detected model format: dylora_moe
Inferred base model: google/codegemma-2b
Loading DyLoRA-MoE model...
Initializing DyLoRA-MoE: 4 experts, r=16, alpha=32
python : 
At line:1 char:32
+ ... PYTHONIOENCODING="utf-8"; python test_peft_moe_simple.py 2>&1 | Out-F ...
+                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|ΓûêΓûêΓûêΓûêΓûê     | 1/2 [00:01<00:01,  1.72s/it]
Loading checkpoint shards: 100%|ΓûêΓûêΓûêΓûêΓûêΓûêΓûêΓûêΓûêΓûê| 2/2 [00:01<00:00,  1.15it/s]
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's 
`attention_mask` to obtain reliable results.
Loading weights from: model.safetensors
Γ£ô Loaded DyLoRA-MoE weights from: model.safetensors
Γ£ô Model loaded successfully
Loading tokenizer from model path: artifacts\best-dylora-model-full-v16\best_model
Γ£ô Tokenizer setup complete

================================================================================
PeftMoEDecoder initialized:
  Model format: dylora_moe
  Base model: google/codegemma-2b
  Routing strategy: router
  Device: cuda
  EOS tokens: ['<|endoftext|>', '<|endofmask|>', '</s>', '\nif __name__', '\ndef main(', '\nprint(', '\ndef ', '\nclass ', '\nimport ', '\nfrom ', '\nassert ']
================================================================================


Model loaded successfully!
Format: dylora_moe
Device: cuda

============================================================
Testing code generation...
============================================================
Prompt:
def add(a, b):
    """Add two numbers and return the result."""


Generated 1 sample(s)
Output length: 768 characters

============================================================
Generated code:
============================================================

































































































































































































































































































































































































































































































































































































































































































































































































============================================================


============================================================
Testing HumanEval-style prompt...
============================================================
Prompt:
from typing import List


def has_close_elements(numbers: List[float], threshold: float) -> bool:
    """ Check if in given list of numbers, are any two numbers closer to each other than
    given threshold.
    >>> has_close_elements([1.0, 2.0, 3.0], 0.5)
    False
    >>> has_close_elements([1.0, 2.8, 3.0, 4.0, 5.0, 2.0], 0.3)
    True
    """


Generated 1 sample(s)
Output length: 768 characters

============================================================
Generated code:
============================================================

































































































































































































































































































































































































































































































































































































































































































































































































============================================================


All tests completed successfully!
